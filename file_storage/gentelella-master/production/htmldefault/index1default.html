<!DOCTYPE html>
<html lang="ko">  <!-- en 이였음 -->

<!-- 헤더에는 로컬 디스크에서 스타일쉬트 가져오는걸로 끝난다 -->
<head>
    <script src="../production/serveraddr.js"></script>

    <script>
        //alert(server_url)
        var ws = new WebSocket("ws://"+server_url+":8100/websocket");
        var indexmacaddr;
        var table;
        array1=indexmacaddr.split(';');
        array1.pop();
        var table1=array1.pop();
        table=table1.substr(6);
        console.log(table);
        console.log(array1);
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- 캐쉬 안쌓이게 해보자.... -->
    <META http-equiv="Expires" content="-1">
    <META http-equiv="Pragma" content="no-cache">
    <META http-equiv="Cache-Control" content="No-Cache">

    <!-- 파비콘을 설정한다. png 를 ico로 변환하는 과정이 필요 -->
    <link rel="shortcut icon" href="./jmpsys_wifi.ico" >

    <title>uManager 3.3</title>

    <!-- Bootstrap -->
    <link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 링크 엘리먼트는 웹url이 지정하는 파일을 스타일쉬트와 연결시켜준다
    즉 CSS 내용을 축적하여 만들어 나가기 위한 것이지 자바스크립트와는 관계가 없다. -->
    <!-- Font Awesome -->
    <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="../vendors/iCheck/skins/flat/green.css" rel="stylesheet">
    <!-- Datatables -->
    <link href="../vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="../vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css" rel="stylesheet">
    <link href="../vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css" rel="stylesheet">
    <link href="../vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
    <link href="../vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css" rel="stylesheet">

    <!-- bootstrap-progressbar -->
    <link href="../vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
    <!-- JQVMap -->
    <link href="../vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet"/>
    <!-- bootstrap-daterangepicker -->
    <link href="../vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="../build/css/custom.min.css" rel="stylesheet">

    <style>
    table.dataTable.select tbody tr,
    table.dataTable thead th:first-child {
    cursor: pointer;
    }
    </style>

</head>

<body class="nav-md">

<!-- 숨겨진 레이어 -->

<!-- 숨겨진 레이어 -->


<div class="container body">
    <div class="main_container">
        <div class="col-md-3 left_col">
            <div class="left_col scroll-view">
                <div class="navbar nav_title" style="border: 0;">
                    <a href="index.html"><center> <img src="images/logo.png"style="width:90%;height:90% ;"></center></a>
                </div>

                <div class="clearfix"></div>

                <!-- menu profile quick info -->
                <div class="profile clearfix">
                    <div class="profile_pic">
                        <img src="images/jsn270.png" alt="..." class="img-circle profile_img">
                    </div>
                    <div class="profile_info">
                        <span>Wemcome,</span>
                        <h2>Manager</h2>
                    </div>
                </div>
                <!-- /menu profile quick info -->

                <br />

                <!-- sidebar menu -->
                <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
                    <div class="menu_section">
                        <h3>JMPSYSTEMS uManager 3.3</h3>
                        <ul class="nav side-menu">
                            <li><a><i class="fa fa-area-chart"></i> Basic Management <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li><a href='index.html'>Status</a></li>
                                    <li><a href='index1.html'>Management</a></li>
                                    <!--li><a href='index2.html'>AP 관계도</a></li-->
                                </ul>
                            </li>
                            <li><a><i class="fa fa-archive"></i> Field Management <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li><a onclick="mapinfo()">Outdoor</a></li>
                                    <li><a href='indoor.html'>Indoor</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="menu_section">
                        <!--h3>개발예정 메뉴</h3-->
                        <ul class="nav side-menu">
                            <!--li><a><i class="fa fa-bug"></i> 버그신고 <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li><a target="_blank" href="http://www.jmpsys.com">개발자에게 알리기</a></li>
                                    <li><a href='#Redirect'>프로젝트 블로그</a></li>
                                </ul>
                            </li-->
                            <li><a target="_blank" href="http://www.jmpsys.com"><i class="fa fa-laptop"></i> Go JMP Site <span class="label label-success pull-right">JMPSYS</span></a></li>
                        </ul>
                    </div>

                </div>
                <!-- /sidebar menu -->

                <!-- /menu footer buttons -->
                <div class="sidebar-footer hidden-small">
                    <!--a data-toggle="tooltip" data-placement="top" title="Settings">
                        <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
                    </a>
                    <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                        <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
                    </a>
                    <a data-toggle="tooltip" data-placement="top" title="Lock">
                        <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
                    </a>
                    <a-- data-toggle="tooltip" data-placement="top" title="Logout">
                        <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
                    </a-->
                </div>
                <!-- /menu footer buttons -->
            </div>
        </div>
        <!-- top navigation -->
        <div class="top_nav">
            <div class="nav_menu">
                <nav>
                    <div class="nav toggle">
                        <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                    </div>

                    <ul class="nav navbar-nav navbar-right">
                        <!--li class="">
                            <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                <img src="images/jsn270.png" alt="">무선 관리자
                                <span class=" fa fa-angle-down"></span>
                            </a>
                            <ul class="dropdown-menu dropdown-usermenu pull-right">
                                <li><a href="javascript:;"> Profile</a></li>
                                <li>
                                    <a href="javascript:;">
                                        <span class="badge bg-red pull-right">50%</span>
                                        <span>Settings</span>
                                    </a>
                                </li>
                                <li><a href="javascript:;" onclick="changeprof();">아이디, 패스워드 변경</a></li>
                                <li><a href="login.html"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                            </ul>
                        </li-->

                        <!--  우상단 관리자 아이콘 풀다운 메뉴 꾸미기...
                        <li role="presentation" class="dropdown">
                            <a href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-envelope-o"></i>
                                <span class="badge bg-green">6</span>
                            </a>
                            <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                                <li>
                                    <a>
                                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <div class="text-center">
                                        <a>
                                            <strong>See All Alerts</strong>
                                            <i class="fa fa-angle-right"></i>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        -->
                    </ul>
                </nav>
            </div>
        </div>
        <!-- /top navigation -->

        <!-- page content -->
        <div class="right_col" role="main">  <!-- 오른쪽 전체를 지칭 -->
            <!-- 여기까진 모든 젠텔레라 페이지가 똑같다...-->

            <!-- top tiles -->
            <div class="row tile_count"> <!-- 최상단 카운터들 -->
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    <span class="count_top"><i class="fa fa-user"></i> Download</span>
                    <div class="count" id="A00">0</div>  <!-- A00 에 값 대입 -->
                    <!--span><i class="fa fa-user"></i> Total Download Trafic</span-->
                </div>
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    <span class="count_top"><i class="fa fa-clock-o"></i> Upload</span>
                    <div class="count"  id="A01">0</div>
                    <!--i class="fa fa-clock-o"></i> <span>Total Upload Trafic</span-->
                </div>
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    <span class="count_top"><i class="fa fa-user"></i> Trafic</span>
                    <div class="count green" id="A02" >0</div>
                    <!--i class="fa fa-user"></i> <span>Real Time Trafic</span-->
                </div>
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    <span class="count_top"><i class="fa fa-clock-o"></i> Service Time</span>
                    <div class="count" style="font-size:30px" id = "A03" >0</div>
                    <!--i class="fa fa-clock-o"></i><span> Operation Time</span-->
                </div>
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    <span class="count_top"><i class="fa fa-user"></i> Operating Rate</span>
                    <div class="count" id= "A04">0</div>
                    <i id="A04rate" class="green">34%</i>
                </div>
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    <span class="count_top"><i class="fa fa-user"></i> Registration Equipment</span>
                    <div class="count" id= "A05"></div>
                    <!--i class="fa fa-user"></i> <span>Registration Equipment</span-->
                </div>

            </div>    <!-- 우측공간 최상단 카운터들 -->
            <!-- /top tiles -->
            <hr/>    <!-- 우측공간 최상단 카운터들 -->
            <!-- /top tiles -->
            <div class="clearfix"></div>

            <!-- 블럭을 shrink 한줄만 copy 해오면 되네.. 블럭을 인식하는건 역시 this is webstorm !!
            <div class="">  <!-- 우측공간 최상단 카운터 아래쪽 공간 정의 -->

                <div class="page-title">
                    <div class="title_left">
                        <!-- 파파 아이콘 사용 -->
                        <h3><i class="fa fa-cogs" aria-hidden="true"></i> Wireless AP list for management</i></h3>
                    </div>

                    <div class="title_right">
                        <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right top_search">
                            <div class="input-group">
                                <!--input type="text" class="form-control" placeholder="Search for...">
                                <span class="input-group-btn">
                      <button class="btn btn-default" type="button" onclick="top_go_button_click();">Go!</button>
                    </span-->
                            </div>
                        </div>
                    </div>
                </div>  <!-- 테이블 감싸고 제품과 오른쪽 더비 써치 & Go -->

                <div class="clearfix"></div>

                <div class="row"> <!-- 우측 공간에서 row 하나 만든다. -->
                                                      <!-- xs < 768 | sm > 768 | md > 992 | lg > 1200
                            <div id="show_file" class="col-md-6">
                    <!-- 부트스트랩 정의 ::  컨테이너 너비   auto   |   750px  |   970px  |   1170px -->

                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>WiFi AP list</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                    </li>
                                    <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                        <!--ul class="dropdown-menu" role="menu">
                                            <!--li><a href="#">Settings 1</a>
                                            </li>
                                            <li><a href="#">Settings 2</a>
                                            </li>
                                        </ul-->
                                    </li>
                                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">

                                <!-- 첵빡 이렇게 주석을 해당 태그안에 넣으면 해당 태그 참조할때 주석까지 같이 따라감... 반드시 주석은 태그 외부에..-->
                                <!-- 클레스가 원래 display select 였음  -->
                                <form id="frm-example" >
                                    <table id="example" class="table table-striped jambo_table table-bordered dt-responsive nowrap" style="text-align: center" cellspacing="0" width="100%">
                                        <thead>

                                        <tr class="headings">  <!-- 첫줄 이쁘게 하기 -->
                                            <th style="text-align: center"><input name="select_all" value="1" type="checkbox" ></th>
                                            <th style="text-align: center" class="column-title">Registration time</th>
                                            <th style="text-align: center" class="column-title">modelName</th>
                                            <th style="text-align: center" class="column-title">ipAddr</th>
                                            <th style="text-align: center" class="column-title">rf0 Ch</th>
                                            <th style="text-align: center" class="column-title">rf1 Ch</th>
                                            <th style="text-align: center" class="column-title">Ver</th>
                                            <th style="text-align: center"class="column-title">id</th>
                                            <th style="text-align: center" class="column-title">macAddr</th>
                                            <th style="text-align: center" class="column-title">flagConf</th>
                                            <th style="text-align: center" class="column-title">flagFirm</th>
                                            <th style="text-align: center" class="column-title">lastRx</th>
                                            <th style="text-align: center" class="column-title">devDesc</th>
                                        </tr>
                                        </thead>
                                        <tfoot>
                                        <tr class = "headings">
                                            <th></th>   <!-- 풋터에서는 입력 영역을 비워둔다 -->
                                            <th style="text-align: center">Registration time</th>
                                            <th style="text-align: center">modelName</th>
                                            <th style="text-align: center">ipAddr</th>
                                            <th style="text-align: center">rf0 Ch</th>
                                            <th style="text-align: center">rf1 Ch</th>
                                            <th style="text-align: center">Ver</th>
                                            <th style="text-align: center">id</th>
                                            <th style="text-align: center">macAddr</th>
                                            <th style="text-align: center">flagConf</th>
                                            <th style="text-align: center">flagFirm</th>
                                            <th style="text-align: center">lastRx</th>
                                            <th style="text-align: center">devDesc</th>
                                        </tr>
                                        </tfoot>
                                    </table>

                                    <button id="firmUp" class="btn btn-warning" onclick="firmUpNotify();">Upload F/W</button>

                                    <button id="confUp" class="btn btn-success" >Upload Settings</button>

                                    This button Must be Handled By Manager
                                    <pre id="example-console"> </pre>
                                </form>  <!-- 첵빡 폼 -->
                                <button id="firmwrite" class="btn btn-warning" onclick="writeNotify(1);">Write F/W</button>
                                <!--button id="confwrite" class="btn btn-success" onclick="writeNotify(2);" >Write Settings</button-->
                                <button id="applyMulti_wifi_pw" class="btn btn-dark" onclick="multiconfig();">Load Config</button>
                                <button id="confEdit" class="btn btn-info" onclick="confEditNotify();">Edit CF Files</button>
                                <button id="reloadList" class="btn btn-dark" onclick="reloadApList();">Reload AP List</button>
                                <button id="Truncate Table" class="btn btn-dark" style="float: right;" onclick="TruncateTable();">Truncate Table</button>
                            </div>
                        </div>
                    </div> <!-- 체빡 영역 -->

                   <!-- <div  class="col-md-12 col-sm-12 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>관리 패킷 모니터링<small>Real-time Management Packet Monitoring</small></h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                    </li>
                                    <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a href="#">Settings 1</a>
                                            </li>
                                            <li><a href="#">Settings 2</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                                    </li>
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <div  id="ap_table" >
                                    <button class = "btn btn-dark" ># of Data Line</button>
                                    <span class ="btn btn-link" id="packetCnt" style="width: 60px;">0</span>
                                    <button class ="btn btn-link" type="button" style="width:100px;" onclick="javascript:myWebsocketStart()">웹소켓 가속</button>
                                    <span data-highlight-spot-color="0x552112">텍스트창을 클릭하면 클립보드로 캡쳐됩니다.</span>
                                </div>
                                <textarea id="textarea1" name="message" readonly="readonly"
                                          onclick="this.select()"
                                          style= "min-width:100%; max-width:100%; min-height:186px; max-height:186px" >
                                </textarea>
                            </div>
                        </div>
                    </div>  --><!-- 실실간 관리 패킷 보여주기 -- 텍스트 에어리어~ -->

                </div> <!-- 우측 공간에서 row 하나 만든다. --> <!-- 반응형 체크때문에 남겨둔 코드 -->

        </div>  <!-- 오른쪽 전체 끝 -->

    </div>
    <!-- /page content -->

    <!-- footer content -->
    <footer>
        <div class="pull-right">
            uManager version 3.3 ----- <a href="http://www.jmpsys.com">JMPSYSTEMS Co., Ltd.</a>
        </div>
        <div class="clearfix"></div>

    </footer>
    <!-- /footer content -->

</div>
<!-- container body -->


<script>
    function top_go_button_click() {
     location.href="https://www.google.co.kr","_blank";
    }
</script>

<!-- CSS는 헤더에서 젤 먼저 로딩하고 바디에 해당하는 내용들 로딩되고 나서 마지막에 js 스크립트 실행 되는게 순서임...
여기서 죄다 실행시킨다.. 앞으로 옮기면 바디로딩되기 전에 실행되므로 죄다 document.ready 에 우겨 넣어야 하는 불편함이 있다-->
<!-- jQuery -->
<script src="../vendors/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap -->
<!-- 자바스트립트를 코딩하는 대신 파일을 지정하여 물고와서 수행해 버린다.
당연 CSS와는 무관하니 부트스트랩이라는 말때문에 헷갈리지 말길... -->
<script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- FastClick -->
<script src="../vendors/fastclick/lib/fastclick.js"></script>
<!-- NProgress -->
<script src="../vendors/nprogress/nprogress.js"></script>
<!-- Chart.js -->
<script src="../vendors/Chart.js/dist/Chart.min.js"></script>
<!-- bootstrap-progressbar -->
<script src="../vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
<!-- iCheck -->
<script src="../vendors/iCheck/icheck.min.js"></script>
<!-- Datatables -->
<script src="../vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
<script src="../vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
<script src="../vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
<script src="../vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
<script src="../vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="../vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
<script src="../vendors/datatables.net-scroller/js/datatables.scroller.min.js"></script>
<script src="../vendors/jszip/dist/jszip.min.js"></script>
<!-- 이거 동작 수상하다.. 일단 짜름.. pdf 만드는거 같은데.. 가끔식 권한 물어봄
<script src="../vendors/pdfmake/build/pdfmake.min.js"></script>
<script src="../vendors/pdfmake/build/vfs_fonts.js"></script>
<!-- -->

<!-- DateJS -->
<script src="../vendors/DateJS/build/date.js"></script>
<!-- Custom Theme Scripts -->
<script src="../build/js/custom.min.js"></script>
<!-- d3.js -->
<script src="../vendors/d3/d3.min.js"></script>


<!-- 파일로 읽어서 datatable 생성하기 -->

<script>
    /* 타일스타일.. 나중에 구현하기..
$(document).ready(function() {

    var final_table = $('#table333').DataTable({

        dom: "lfrtipB",
        // dom: "B<clear>frtip",
        buttons: [
            {
                extend: "copy",
                className: "btn-sm"
            },
            {
                extend: "csv",
                className: "btn-sm"
            },
            {
                extend: "excel",
                className: "btn-sm"
            },
            */


            /*  빼버림.. 찜찜..
             {
             extend: "pdfHtml5",
             className: "btn-sm"
             },
             */

            /*
            {
                extend: "print",
                className: "btn-sm"
            },
        ],
        responsive: true,

// 체크박스 찍는거 정의하는 부분
        "order": [[1, 'asc']],
        "'columnDefs": [
            {orderable: false, targets: [0]}
        ],
        "ajax": "../json_data/objects.txt",

        "columns": [
        { "data": "name" },
        { "data": "position" },
        { "data": "office" },
        { "data": "extn" },
        { "data": "start_date" },
        { "data": "salary" }
        ]

    } );
} );
*/

</script>


<!-- 웹소켓 -->
<script>
    /*
    var webSocOrigin = "local"; // "local"; // to do : 들어오는 소스에 따라 자동변경 필요함.. 특히 핸드폰에서 들어올때.. 이것뿐이 아니라 모든 JS에서 호출하는 기능이 죄다 동일한 문제가 있음

    var server_row_msg = ""; // 서버로 부터 받은 업데이트 할 row
    var aa00 = 0;  // 가로를 영문 세로를 숫자.. 엑셀방식으로 어레이 변수 만들 계획... 구조체 만드는게 개발일임..
    var topCntSub =0;

    function myWebsocketStart() {
        console.log("위이이잉");
        //var ws = new WebSocket("ws://localhost:8000/websocket");
        // 파일서버와 같은 포트 사용한다. 그래야 싱글페이지 앱 입장에서 파일서버에서 품고 있는 html 서비스와 같은 포트를 유지 할 수 있다
        if (webSocOrigin == "internet") {
            var ws = new WebSocket("ws://www.umanager.kr:8100/websocket"); // 아따 정말 오타 오타..   이렇게 갈를것이 아니라 문자로 치환하여 사용해야 한다. 최초 doc 로딩되면 설정 파일 파싱해서 url 확정 해야함..
        } else {
            var ws = new WebSocket("ws://localhost:8100/websocket"); //  // 웹속 받는 쪽도 똑같이 localhost 이어야 함. 127.0.0.1 은 오리진 에러 유발함
        }
        var cnt = 0;
        //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        //this.scrollTop = this.scrollHeight
        ws.onopen = function()
        {
            // Web Socket is connected, send data using send()
            ws.send("piping");
            //var myTextArea = document.getElementById("textarea1");
            // myTextArea.value = myTextArea.value + "\n" + "First message sent";
            //textarea1.scrollTop = textarea1.scrollHeight;
            topCntSub ++;
        };

        ws.onmessage = function (evt)
        {
            /*
            aa00 = aa00 + 1;
            var id_selector = $("#T2500").text();  // 해당 id 셀렉터가 가리키는 태그내의 텍스트를 가져온다
            for (i=0; i<5; i++) {
                document.getElementById("A0"+i.toString()).innerHTML = (aa00 + i*100).toString();
                document.getElementById("B05").innerHTML = topCntSub;
            }
            */
            // document.getElementById("A00").innerHTML = trafficCnt.toString();
            //document.getElementById("packetCnt").innerHTML = aa00.toString()
            // 임시로 자동 등록 수만 구현
            // console.log(evt.data)
            /*var index = evt.data.indexOf("-A05-");  // A05에 해당하는 값이 들어 있는 곳에서 숫자 추출함
            // console.log(index);
            if (index == -1) {
                //document.getElementById("A05").innerHTML = evt.data.substring(index+6, index+9)
            } else {
                document.getElementById("A05").innerHTML = evt.data.substring(index+5, index+8)
            }
            // 디버깅할때 꼭 찍어봐라~~
            server_row_msg = evt.data.substring(4,7);
            spend_time_start=evt.data.lastIndexOf(';');
            spend_time=evt.data.substr(spend_time_start+2);
            var string = evt.data.split(';');
            console.log(string);
            if(string!=""){
            server_row_msg = evt.data.substring(8, evt.data.length);
            console.log(string);
            var myTextArea = document.getElementById("textarea1");
            myTextArea.value = myTextArea.value + server_row_msg
            textarea1.scrollTop = textarea1.scrollHeight;
            cnt = cnt +1

            if (myTextArea.value.length > 1800) {
                myTextArea.value =  myTextArea.value.substring(myTextArea.value.length - 1700);
            }

            if(evt.data == "pong") { // 특정한 동작 할 수도 있음...
            }
        };
        }

        ws.onclose = function()
        {
            textarea1.scrollTop = textarea1.scrollHeight;
            var myTextArea = document.getElementById("textarea1");
            myTextArea.value = myTextArea.value + "\n" + "Connection closed";
        };
    }*/
</script>
<!-- /웹소켓 -->
<script>
    for(var f=0;f<table;f++) {
        document.write('<hidden id = "first"  class="base"></hidden>')
        var rec = "first"+(f);
        document.getElementById("first").id = rec;
        var a= document.getElementById(rec)
        document.getElementById("A05").innerHTML=table;
        if(array1[f]==null){
            document.getElementById(rec).className="Loading";
        }
    }

</script>


<script>



    /*function ws_close(){
     ws.close();
     }
     var checkUnload = true;
     $(window).on("afterunload", function(){
     if(checkUnload) return ws_close();
     });
     */
    //var nStart = new Date().getTime(); //html 켜진 시간
    for(var s=0;s<table;s++){
        eval("stat"+s+"=new Array();");
        eval("test_compare"+s+"=new Array();");
    }
    //var stat0=new Array();
    //stat0,stat2.......  총 40개의 배열 생성 여기다가 상태넣을거.
    var bootstring=[];
    var macstring=[];
    var ipstring=[];
    var comparetime=[];
    var statusstring=[];
    var savetime=[];
    var uploadstring=[];
    var downstring=[];
    var upload=[];
    var download=[];
    var per_minute = [];
    var per_minute1 = [];
    var realtx=[];
    var realrx=[];
    var atach=[];
    var model=[];
    var websocsend=[];

    var uptotal;
    var downtotal;
    var spend_time;
    var string;
    var cross=1;


    window.onload = function()
    {
        // Web Socket is connected, send data using send()
        setTimeout(function(){ws.send("piping");}, 100);
        console.log("핑핑");
        //var myTextArea = document.getElementById("textarea1");
        // myTextArea.value = myTextArea.value + "\n" + "First message sent";
        //textarea1.scrollTop = textarea1.scrollHeight;
        console.log(table);
    };
    ws.onmessage = function (evt)
    {
        //console.log(evt.data);
        spend_time_start=evt.data.lastIndexOf(';');
        spend_time=evt.data.substr(spend_time_start+2);
        spend_timeR=spend_time.split("[]");
        spend_time=spend_timeR[0];
        ////tttt=spend_timeR[1];
        //testtest(tttt)
        //console.log(tttt);
        string = evt.data.split(';');
        //바로가면 안되고 특정문자 기준으로 배열로 나눠서 뿌려준다.
        setTimeout(function(){ws.send("piping");}, 100);
        var err=$('.flag5').length;
        var notyet=$('.base').length;
        var und=$('.Loading').length;
        var wait=$('.flag4').length;
        work=table-err-notyet-wait-und.toString();
        total=table-und.toString();
        document.getElementById("A04").innerHTML=work+" / "+total;
        if (string!=""&&evt.data.indexOf("table:")==-1) {
            web_soc_html();
        }
    }
    function writeNotify(i){
        window.open("http://" + server_url + ":8080/writing?flag="+i,
                "width=480,height=600,toolbar=no,location=no,status=no,left=250,top=" + i*24);

    }
    function web_soc_html(){
        //console.log(spend_time);//서버 열린 시간(초)
        var clocks=Math.floor(spend_time%60);
        var minutes=Math.floor(spend_time/60);
        var hours=Math.floor(minutes/60);
        var day=Math.floor(hours/24);
        /*if(minutes%120==0){ //2시간마다 한번씩 새로고침
         setTimeout(function() {
         window.location.reload(true);

         },1000*60*2)
         }*/
        var string_time=minutes+"M";
        if (minutes>59){
            minutes=minutes%60;
            string_time=hours+"H "+minutes+"M";
            if(hours>23)
            {
                hours=hours%24;
                string_time=day+"D "+hours+"H "+minutes+"M";
            }

        }
        //console.log(string_time)
        document.getElementById("A03").innerHTML=string_time;
        document.getElementById("A03").title=clocks+"sec";
        string.splice(string.length - 1, 1);
        var getstringlength=string.length
        for(j=1;j<getstringlength;j++) {
            string[j] = string[j].substr(1);
        }
        //console.log(string); //맥과 부트가 붙어있는 스트링
        for(i=0;i<getstringlength;i++) {
            var bootstart=string[i].indexOf("부:");
            bootstring[i] = string[i].substr(bootstart+2, 1);
            //console.log(bootstring);
            var macstart=string[i].indexOf("맥:");
            macstring[i]=string[i].substr(macstart+2,17);
            //console.log(macstring);
            var ipstart=string[i].indexOf("아:");
            var ipend=string[i].lastIndexOf("컴:");
            ipstring[i]=string[i].substr(ipstart+2,ipend-ipstart-3);
            //console.log(ipstring);
            var compstart=string[i].indexOf("컴");
            var compend=string[i].lastIndexOf("상태:");
            comparetime[i]=string[i].substr(compstart+2,compend-compstart-3);
            //console.log(comparetime);
            statusstring[i]=string[i].substr(compend+3); //ap트래픽
            var upstart=string[i].indexOf("전송:");
            var upend=string[i].indexOf("수신:");
            uploadstring[i]=string[i].substr(upstart+4,upend-upstart-6);//사용자가 다운로드
            var downstart=string[i].indexOf("수신:");
            var downend=string[i].indexOf("실전:");
            downstring[i]=string[i].substr(downstart+4,downend-downstart-6);//사용자가 업로드
            var realtxend=string[i].indexOf("실수:");
            realtx[i]=string[i].substr(downend+4,realtxend-downend-6)
            var realrxend=string[i].indexOf("붙맥:");
            realrx[i]=string[i].substr(realtxend+4,realrxend-realtxend-6)

            var atachstart=string[i].indexOf("모델:");
            atach[i]=string[i].substr(realrxend+4,atachstart-realrxend-6)
            var modelend=string[i].indexOf("온도:");
            model[i]=string[i].substr(atachstart+4,modelend-atachstart-6)
            // console.log(model[i],atach[i])
          //  console.log(downstring[i])
            //console.log(downstring);
            //console.log(statusstring)
        }
        //var nend = new Date().getTime();
        //var spendtime=(nend-nStart)/1000;
        //console.log(spendtime);
        //alert(macstring.indexOf(array1[0])) //그 맥에해당하는 위치를 알려준다.
        for(i=0;i<getstringlength;i++){
            var inputhere="<h4> "+macstring[i]+" </h4>"+"\n"+"<h5>&nbsp"+ipstring[i]+"&nbsp\n"+"</h5>";
            // console.log(inputhere);
            for(j=0;j<table;j++){
                if(macstring[i]==array1[j]){
                    upload[j]=uploadstring[i];
                    download[j]=downstring[i];
                    //alert(i); 소켓에서 오는 배열 번호
                    //alert(j); 그에 일치하는 화면 배열 번호
                    savetime[j]=comparetime[i];
                    eval("var pus=stat"+j)
                    pus.unshift("\n"+statusstring[i]);
                    if(pus.length>10){
                        pus.pop();
                    }

                    if(bootstring[i]=="0"){

                        document.getElementById('first'+(j)).className="flag0";
                        document.getElementById("first"+(j)).title=pus;
                        // alert("색바뀐당");
                    }
                    else if(bootstring[i]=="1"){
                        document.getElementById('first'+(j)).className="flag1";
                        document.getElementById('first'+(j)).title="플래그1";
                    }
                    else if(bootstring[i]=="2"){
                        document.getElementById('first'+(j)).className="flag2";
                        document.getElementById('first'+(j)).title="플래그2";
                    }
                    else if(bootstring[i]=="3"){
                        document.getElementById('first'+(j)).className="flag3";
                        document.getElementById('first'+(j)).title="플래그3";
                    }
                    else if(bootstring[i]=="4"){
                        document.getElementById('first'+(j)).className="flag4";
                        document.getElementById('first'+(j)).title="플래그4";
                    }
                }
            }
            uptotal=0;
            downtotal=0;
            for(j=0;j<table;j++){
                if(upload[j]!=null) {
                    uptotal += Number(upload[j]);
                    downtotal+=Number(download[j]);
                }
            }
        } //화면과 같은 맥과 부트 배열 위치 찾기

        var cutup=String(uptotal);
        var cutdown=String(downtotal);
        var cutup1=uptotal;
        var cutdown1=downtotal;
        if (cutup1>1023){
            cutup1=(cutup/1024).toFixed(1)
            cutup=cutup1+"K"
        }if (cutup1>1023){
            cutup1=(cutup1/1024).toFixed(1)
            cutup=cutup1+"M"
        }if (cutup1>1023){
            cutup1=(cutup1/1024).toFixed(1)
            cutup=cutup1+"G"
        }if (cutup1>1023){
            cutup1=(cutup1/1024).toFixed(1)
            cutup=cutup1+"T"
        }if (cutdown1>1023){
            cutdown1=(cutdown/1024).toFixed(1)
            cutdown=cutdown1+"K"
        }if (cutdown1>1023){
            cutdown1=(cutdown1/1024).toFixed(1)
            cutdown=cutdown1+"M"
        }if (cutdown1>1023){
            cutdown1=(cutdown1/1024).toFixed(1)
            cutdown=cutdown1+"G"
        }if (cutdown1>1023){
            cutdown1=(cutdown1/1024).toFixed(1)
            cutdown=cutdown1+"T"
        }
        /* if(cutup.length>4){
         cutup1=(cutup/1024).toFixed(1)+"K"
         cutup=cutup.substring(0,cutup.length-3)
         console.log(cutup)
         console.log(cutup1)
         }if(cutup.length>4){
         cutup1=(cutup/1024).toFixed(1)+"M"
         cutup=cutup.substring(0,cutup.length-4);
         console.log(cutup1)
         }if(cutup.length>4){
         cutup1=(cutup/1024).toFixed(1)+"G"
         cutup=cutup.substring(0,cutup.length-4);
         }if(cutup.length>4){
         cutup1=(cutup/1024).toFixed(1)+"T"
         cutup=cutup.substring(0,cutup.length-4);
         }if(cutdown.length>4){
         cutdown=cutdown.substring(0,cutdown.length-3)+"K";
         }if(cutdown.length>5){
         cutdown=cutdown.substring(0,cutdown.length-4)+"M";
         }if(cutdown.length>5){
         cutdown=cutdown.substring(0,cutdown.length-4)+"G";
         }if(cutdown.length>5){
         cutdown=cutdown.substring(0,cutdown.length-4)+"T";
         }*/
        //부트플래그 넣어보자
        var err=$('.flag5').length;
        var notyet=$('.base').length;
        var und=$('.Loading').length;
        var oprate=Math.floor((table-err-notyet-und)*100/(table-und));

        document.getElementById("A00").innerHTML=cutup;
        document.getElementById("A00").title=AddComma(String(uptotal))+"byte";
        document.getElementById("A01").innerHTML=cutdown;
        document.getElementById("A01").title=AddComma(String(downtotal))+"byte";
        var work=table-err-notyet-und.toString();
        var total=table-und.toString();
        document.getElementById("A04rate").innerHTML=Math.floor(work/total*100)+"%";
        document.getElementById("A04").innerHTML=work+" / "+total;
    }
    function AddComma(data_value) {
        return Number(data_value).toLocaleString('en');
    }
    setInterval(function() {
        if (uptotal != null) {
            per_minute.unshift(uptotal+downtotal);
            if (per_minute.length > 15) {
                per_minute.pop();
            }
            //console.log(per_minute)
            per_minute1.unshift(downtotal);
            if (per_minute1.length > 15) {
                per_minute1.pop();
            }
            //console.log(per_minute1);

            if (per_minute.length > 10) {
                var minute = (per_minute[0] - per_minute[9])/10;
                minute=Math.ceil(minute);
                minute1=minute+"B";
                if(minute>1024){
                    minute=(minute/1023).toFixed(1);
                    minute1=minute+"K";
                }
                if(minute>1024){
                    minute=(minute/1023).toFixed(1);
                    minute1=minute+"M";
                }
                if (minute>1024){
                    minute=(minute/1023).toFixed(1);
                    minute1=minute+"G"
                }
                if (minute<0){}else{
                    document.getElementById("A02").innerHTML = minute1;
                }
                document.getElementById("A02").style="cursor:default";
                //console.log(per_minute, minute);
            }
            else {
                document.getElementById("A02").innerHTML = "Loading...";
                document.getElementById("A02").style="cursor:wait";
            }
        }
    },1000);

    setTimeout(function(){
        setInterval(function(){
            for(i=0;i<table;i++) {
                eval("var pus=test_compare"+i)
                pus.push(savetime[i]);
                start_pus=pus.indexOf();
                last_pus=pus.lastIndexOf(!null);
                // console.log(pus,start_pus,last_pus,i);
                if(pus[0]==pus[1]){
                    if(document.getElementById('first'+(i)).className!="Loading") {
                        document.getElementById('first' + (i)).className = "flag5";
                        document.getElementById('first'+(i)).title="No response From Ap";
                        websocsend.push(" "+array1[i]);
                        //var asdfeg=array1[i];
                        //ws.send(asdfeg)


                    }
                }

                if(pus.length>2){
                    pus.shift();
                }
            }
            console.log(websocsend);
            send_soc();
            console.log(websocsend);
        },1000*60*5); //5분

    },30000);

    function AddComma(data_value) {
        return Number(data_value).toLocaleString('en');
    }

    function send_soc(){
        setTimeout(function(){ws.send("errmac "+websocsend);}, 100);
        setTimeout(function(){ websocsend=new Array();}, 1000*2);
    }

    /*
     setInterval(function(){
     window.location.reload(true);
     },1000*60*60*1); //1시간마다 한번씩 리프레쉬
     */

    /* 장비가 죽었는지 확인하는 방법 1)
     setInterval(function(){
     for(i=0;i<table;i++)
     savetime1[i]=savetime[i];
     console.log(savetime1,"CCCCC"); //N초마다 savetime1에 저장.
     setTimeout(function() {
     for(i=0;i<table;i++){
     if(savetime1[i]===savetime[i]){
     if(document.getElementById('first'+(i)).className!="Loading") {
     document.getElementById('first' + (i)).className = "flag5";
     }
     }
     }
     console.log(savetime1,"AAAAAAAA");
     console.log(savetime,"BBBBBBBB");
     }, 1000*60*2);
     },1000*60*10);

     */


    /*for(i=0;i<table;i++){
     if(savetime1[i]===savetime[i]){
     document.getElementById('first'+(i)).className="flag5";
     }
     }
     console.log(savetime1);
     console.log(savetime);*/



</script>
<!-- 테이블에 마우스 클릭시 값 갱신 -->
<script>
    // 자바스크립트에서 배열이란 문자열 이름과 짝을 이루는 임의의 값들. 배열 길이는 하나 더 큰 값 가짐.
    // 이전 스크립트에서 선언한 변수와 함수는 글로벌이므로 여기서 사용가능
    // 스크립트 엘리먼트 단위 순서대로 실행되며,
    // 단위 스크립트 엘리먼트 내에서는 함수선언을 먼저시행하고 함수밖의 문장을 순서대로 실행
    // 함수를 선언한것이 아니라 함수 선언하는 방법으로 객체를 선언한 것 : var plus = function(a,b) { return a+ b; };

/* 타일 스타일, 마우스오버, 실시간 표출 재구현 예쩡...
function live_update() {   // 당장은 불릴 일이 없다
<!-- 마우스 포인터 위치에 레이어 띄우기 -->
<!-- 마우스 포인터 위치에 레이어 띄우기 -->


    $("#2").mouseenter(function(){
            $(document).mousemove(function(e){
                $('#mouse_posi').html( e.pageY + ":" + e.pageY)
            });

        });
    $("#2").mouseleave(function(){
            setTimeout(function(){
                $('#mouse_posi').html("");
            }, 2000);
        });
    $("#1").mouseenter(function(){
            jQuery.get("../json_data/my_data.json", function(data) {
                //process text file line by line
                $('#show_file').html(data.replace('n',''));
            });
        });
    $("#1").mouseleave(function(){

            setTimeout(function(){
                $('#show_file').html("");
            }, 1000);
        });


        var table = $('#table333').DataTable()
        $('#table333 tbody').on( 'click', 'td', function () {
            var cell = table.cell( this );
            cell.data( "its---me" ).draw();    // 쓰는 순간 소팅 걸려서 테이블이 변화한다.. 별로 보기 않좋음..
            // 이것은 모든 JS와 무관하게 순전히 HTML5 DOM 모델에 따라 <td> 의 위치가 나오는 것임 !!
            // alert('My position in table is: '+this.cellIndex+'x'+this.parentNode.rowIndex);
            var x_index = this.cellIndex;
            var y_index = this.parentNode.rowIndex;
            // 셀 지정할때 row 가 먼저다...즉, y 축이 먼저다..
            // 소팅걸려 있으면 찍은 위치가 아니라, 소팅되어 변경된 테이블 위치를 가르킨다
            console.log(x_index, y_index)
        } );
    }

     */
</script>
<!-- /테이블에 마우스 클릭시 값 갱신 -->

<script>

function firmUpNotify(){
    console.log("펌웨어 버튼 눌러짐.. 나중에 웹t 표출에서만 바꾸면 됨..")
    FirmwareFlagValue = 7878;
    ConfigFlagValue = 0;
}


function confEditNotify(){
    var macAddrs = rows_selected;
    var newName = "Edit_Config";
    for (var i in macAddrs) {
        window.open("http://" + server_url + ":8080/editconfig?macAddr=" + macAddrs[i], newName + macAddrs[i],
                "width=480,height=600,toolbar=no,location=no,status=no,left=250,top=" + i*24);
        console.log(macAddrs[i], i);
    }
}

function reloadApList() {
    var date = new Date();
    var year  = "" + date.getFullYear(); // 문자로 변환
    var month = date.getMonth() + 1; // 0부터 시작하므로 1더함
    if (month < 10) {
        var mon = "0" + month
    } else {
        var mon = "" + month
    }
    var st = year + mon;
    window.open("http://" + server_url + ":8080/reloadaplist?yearmonth=" + st,"nodeok","menubar=0 width=1, height=1");
    setInterval(function() {
        location.reload();
    },1000);



}
function TruncateTable(){
    var conff=confirm("Delete All Ap List.\n Do not Use this if You're not Manager.")
    if ( conff== true){
       window.open("http://" + server_url + ":8080/truncate?truncate=ok");
    }else{
        alert("취소 되었습니다. (문의 : www.jmpsys.com)\n")
    }
}

function multiconfig() {
    var macAddrs = rows_selected;
    console.log(macAddrs)
    if(confirm("You Select "+num_update+" Ap\nPress Ctrl+s to Save Loaded Config File")==true){
        for(i=0;i<num_update;i++){
            console.log(macAddrs[i])
           window.open("http://" + server_url + ":8080/loadconfig?macaddr="+macAddrs[i],macAddrs[i],"width=480,height=600,toolbar=no,location=no,status=no,left=250,top=" + i*24);
        }


    }else{
        alert("Canceled")
    }
    /*if(num_update-1<10){//현재 최대 생성 가능한 테이블 수

        if (num_update != 0) {
            var macAddrs = rows_selected;
            var macarray = new Array();
            var querysend = "";
            var a = 1;
            for (j = 0; j < num_update; j++) {
                var querysend = querysend + "macAddr" + a + "=" + macAddrs[j] + "&";
                a = a + 1;
//&macAddr={{.MacAddr}}&Lan_ipaddr={{.Lan_ipaddr}}&Lan_netmask={{.Lan_netmask}}&Lan_gateway={{.Lan_gateway}}&SSID_2G={{.SSID_2G}}&WPAPSK_2G={{.WPAPSK_2G}}&SSID_5G={{.SSID_5G}}&WPAPSK_5G={{.WPAPSK_5G}}
            }
            console.log(querysend);
            var sumall = "http://" + server_url + ":8080/setmulticonfig?" + querysend + "Num_update=" + num_update;
            console.log(sumall + "########")
            window.open(sumall, "multiConfig", "width=1400,height=600,toolbar=no,resize=no,location=no,status=no,left=250,resizable=no,top=" + j * 24);
        }
    }
    else{
        alert("최대 10개까지 선택 가능합니다");
    }*/
}

</script>

<!-- /첵빡 테이블 -->

<script>
//

// Updates "Select all" control in a data table
//
function updateDataTableSelectAllCtrl(table){
    var $table             = table.table().node();
    var $chkbox_all        = $('tbody input[type="checkbox"]', $table);
    var $chkbox_checked    = $('tbody input[type="checkbox"]:checked', $table);
    var chkbox_select_all  = $('thead input[name="select_all"]', $table).get(0);

    // If none of the checkboxes are checked
    if($chkbox_checked.length === 0){
        chkbox_select_all.checked = false;
        if('indeterminate' in chkbox_select_all){
            chkbox_select_all.indeterminate = false;
        }

        // If all of the checkboxes are checked
    } else if ($chkbox_checked.length === $chkbox_all.length){
        chkbox_select_all.checked = true;
        if('indeterminate' in chkbox_select_all){
            chkbox_select_all.indeterminate = false;
        }

        // If some of the checkboxes are checked
    } else {
        chkbox_select_all.checked = true;
        if('indeterminate' in chkbox_select_all){
            chkbox_select_all.indeterminate = true;
        }
    }
}

var num_update =0; // 장비 선택한 숫자 세기
var rows_selected = [];
$(document).ready(function (){
    // Array holding selected row IDs
    //var rows_selected = [];




    var table = $('#example').DataTable({
        'ajax': '../../showAp',   // 상위 폴더의 상위 폴더
        'columnDefs': [{
            'targets': 0,
            'searchable':false,
            'orderable':false,
            'width':'1%',
            'className': 'dt-body-center',
            'render': function (data, type, full, meta){
                return '<input type="checkbox">';    // 타잎이 checkbox 이면 input을 렌더링 한다
            }
        }],
        'order': [1, 'asc'],
        'rowCallback': function(row, data, dataIndex){
            // Get row ID
            var rowId = data[0];

            // If row ID is in the list of selected row IDs
            if($.inArray(rowId, rows_selected) !== -1){
                $(row).find('input[type="checkbox"]').prop('checked', true);
                $(row).addClass('selected');
            }
        }
    });

    // Handle click on checkbox  테이블 몸통 클릭했을때 처리하는 루틴
    $('#example tbody').on('click', 'input[type="checkbox"]', function(e){
        var $row = $(this).closest('tr');
        console.log("$row:", $row)
        // Get row data
        var data = table.row($row).data();
        console.log("data:", data)
        // Get row ID
        var rowId = data[8];  /// 야야야.. 정신좀..
       // alert(rowId)
        // Determine whether row ID is in the list of selected row IDs
        // $.inArray(찾는값 , 대상배열)   찾는값의 인덱스를 반환 (첫자리는 0, 없으면 -1)
        var index = $.inArray(rowId, rows_selected);
        console.log("rowid:", rowId)
        console.log("row_selected:", rows_selected)
        console.log("index:", index)

        // If checkbox is checked and row ID is not in list of selected row IDs
        if(this.checked && index === -1){
            rows_selected.push(rowId);
            num_update ++;  // 업뎃할 장비 갯수 하나 더 해주자
            // Otherwise, if checkbox is not checked and row ID is in list of selected row IDs
        } else if (!this.checked && index !== -1){
            rows_selected.splice(index, 1);
            num_update --;  // 업뎃할 장비 갯수 카운터 하나 빼주자
        }
        // 선택된 MAC 주소들을 rows_selected 에 축적해 나가거나 이미 체크가 된 애들이면 뺀다..

        if(this.checked){
            $row.addClass('selected');
        } else {
            $row.removeClass('selected');
        }

        // Update state of "Select all" control
        updateDataTableSelectAllCtrl(table);

        // Prevent click event from propagating to parent
        e.stopPropagation();  // 이벤트가 여기서 끝나도 더이상 전파되지 않도록 해준다
    });

    // Handle click on table cells with checkboxes  체크박스 처리하는 루틴
    $('#example').on('click', 'tbody td, thead th:first-child', function(e){
        $(this).parent().find('input[type="checkbox"]').trigger('click');
    });

    // Handle click on "Select all" control  한방에 전체 체크할때 처리하느 루틴
    $('thead input[name="select_all"]', table.table().container()).on('click', function(e){
        if(this.checked){
            $('#example tbody input[type="checkbox"]:not(:checked)').trigger('click');

        } else {
            $('#example tbody input[type="checkbox"]:checked').trigger('click');
        }
        // Prevent click event from propagating to parent
        e.stopPropagation();
    });

    // Handle table draw event
    table.on('draw', function(){
        // Update state of "Select all" control
        updateDataTableSelectAllCtrl(table);
    });

    // Handle form submission event  서버에 선택한 AP들 알려주는 루틴
    $('#frm-example').on('submit', function(e){
        var form = this;
        // 폼 이기때문에 어떤 버튼을 누르던지 submit 이벤트로 여기까지 오게됨..
        console.log("=====================",rows_selected)
        // DOM & form 을 이용하여 submit 할 요소들 모아본다
        // Iterate over all selected checkboxes
        // $.each (콜렉션, 콜백 함수(인덱스배열, 요소값)
        $.each(rows_selected, function(index, rowId){
            // Create a hidden element
            $(form).append(
                $('<input>')
                    .attr('type', 'hidden')
                    //.attr('name', 'id[]')
                    .attr('name', 'macAddr')  /// name이 url 데이타의 key 값이 되고 그 뒤에 붙은게 value 가 된다.
                    .val(rowId)
            );
            console.log(form)
        });

        // FOR DEMONSTRATION ONLY

        // Output form data to a console
        // url 형태의 데이타이므로 이것을 그대로 put 메소드로 패스 8080/apUpdata/에다가 주면 되지 않겠어?
        // 그거 받아 처리하는 곳에서는 그냥 해당 MAC DB에 체크만 해주면 끝~~
        // 자료 정리할때 MAC을 첫 컬럼 번호에도 넣고 중간에 MAC에도 넣자.. 그러면 테이블에서 안보여도 된다는 것 아니겠니? 즉 rowid = mac 인거지...
        // example_length=100&select_all=1&id%5B%5D=00%3A06%3A7a%3Ae7%3A21%3A88
        // 길이는 10, 25, 50, 100 중에서 하나이고 id[]=00:06:7a:12:23:34 이런식으로 url 값으로 전달된다.
        $('#example-console').text($(form).serialize());   // 폼 내부의 요소들을 한방에 표준 url parameter 형식의 텍스크로 변환
                                                           // id로 선택한 요소(즉, 이그젬플콘솔)에 form에 붙어있는 텍스트들을 url 형태로 만들어 붙인다
                                                           // 폼은 결국 인풋들의 모음이므로 jQuery의 힘으로 폼을 시리얼라이즈 한다는건.. input에 있는 정보를 모은다는것임
                                                           // 대상 요소는 input , textarea,  selet 임.

        // console.log("Form submission", $(form).serialize());
        var up_msg = $(form).serialize();

        // Remove added elements
        $('input[name="macAddr"]', form).remove();  // 폼 시리얼라이즈 이후에 지워버린다. 즉, 따로 변수를 쓰는게 아니고 DOM의 공간을 빌리고
                                                   // DOM의 요소 특성, 여기서는 FORM 이지.. 뿌러스 제이쿼리 힘으로 쉽게 원하는 결과를 얻기 위함 (API 최대한 활용하여 일반적이고 표준적인 방법으로 코딩)

        // Prevent actual form submission
        //preventDefault() 는 브라우져의 기본 이벤트를 해제 시킨다.
        //stopPropagation() 은 사용자가 등록한 이벤트를 해제 시킨다.
        e.preventDefault(); // 이게 업으면 브라우저가 리로드 되버린다. 선택한 것들도 풀려 버린다..

        if (num_update < 1) {
            alert("Device is Not Selected.\nChoose Device from Table\n")
        }
        else {

            if (confirm("Total " + num_update + "devices are selected\n" +
                    "Press OK to continue.\n\n" +
                    "[Warning!] F/W Update and Change Config\n" +
                    "Must be Handled By Manager And Also\n" +
                    "Check the Whole Progress\n\n(1) Check File (2) Check Version (3) Check MD5") == true) {

                alert("Save Config File cost 1 Minute\n\nF/W Update cost 5 Munute\n")
                send_ap_update_msg(up_msg);
            }
            else  {
                alert("Canceled (Contact : www.jmpsys.com)\n")
            }
        }

    });
});

var FirmwareFlagValue = 0;
var ConfigFlagValue = 0;
var doConfEdit = 0;
var whitchFlag = 0;
function send_ap_update_msg(query_data){
    //var winOption = "width=370, height=360, resizable=no, scrollbars=no, status=no;"
    //location.href= "http://www.umanager.kr/?macAddr=00:06:7a:23:34:45";
    // www.umanager.kr:8080/setflagall?flagFirm=1&flagConf=1&macAddr=00:06:7a:e7:20:88&magic=415$$
    if (FirmwareFlagValue === 7878) {  // 첨에 꼬여서... 할수 없이 일단은 서로 바꿔서 보낸다...
        FirmwareFlagValue = 0;
        ConfigFlagValue =1;
    }
    else {
        FirmwareFlagValue = 1;
        ConfigFlagValue =0;
    }
    // console.log("==+++==", server_url) // 스트립트 밖에 있는 변수도 잘 먹는다 어짜피 같은 DOM 내부...
    updateRequestString = "http://" + server_url + ":8080/setflagall?flagFirm=" + FirmwareFlagValue + "&flagConf=" + ConfigFlagValue +"&" + query_data;
    console.log (FirmwareFlagValue, ConfigFlagValue, updateRequestString)
    window.open(updateRequestString); // resultNewWindow 하나로만 계속 보여준다
}

<!-- 웹소켓 발동 걸어주기...-->
/*$(document).ready(function () {
    myWebsocketStart()

});*/
function changeprof(){
    window.open("http://" + server_url + ":8080/changeprof?before=yes","IDPWCHANGE","width=350,height=200,toolbar=no,resize=no,location=no,status=no,left=250");
}
function mapinfo(){
    showopen=window.open("http://" + server_url + ":8080/maploc","nodeok","menubar=0 width=1, height=1");
    setInterval(function() {
        showopen.close();
        location.href="mapmak.html";
    },1000);
}
</script>
<!-- /첵빡 테이블 -->

</body>

</html>
